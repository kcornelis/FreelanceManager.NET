@inherits Nancy.ViewEngines.Razor.NancyRazorViewBase<FreelanceManager.Web.ViewModels.TimeRegistration.ImportViewModel>
@{
    ViewBag.Title = "Time Registration - Import";
}

@section Menu{
    <li><a href="/timeregistration">Registrations</a></li>
    <li><a href="/timeregistration/report">Report</a></li>
    <li class="active"><a href="/timeregistration/import">Import</a></li>
    <li><a href="/timeregistration/export">Export</a></li>
}

<h1 class="text-center">Import</h1>

@if (Model.ColumnNames != null)
{
    <form method="post" action="/timeregistration/import">
        <input type="hidden" name="serverFile" value="@Model.ServerFile" />

        <div class="form-group">
            <label for="clientIdColumn">Client column</label>
            <select id="clientIdColumn" name="clientIdColumn" class="form-control selectpicker">
                @foreach (var column in Model.ColumnNames)
                {
                    <option value="@column.Column">@column.Name</option>
                }
            </select>
        </div>

        <div class="form-group">
            <label for="projectIdColumn">Project column</label>
            <select id="projectIdColumn" name="projectIdColumn" class="form-control selectpicker">
                @foreach (var column in Model.ColumnNames)
                {
                    <option value="@column.Column">@column.Name</option>
                }
            </select>
        </div>

        <div class="form-group">
            <label for="taskColumn">Task column</label>
            <select id="taskColumn" name="taskColumn" class="form-control selectpicker">
                @foreach (var column in Model.ColumnNames)
                {
                    <option value="@column.Column">@column.Name</option>
                }
            </select>
        </div>

        <div class="form-group">
            <label for="rateColumn">Rate column</label>
            <select id="rateColumn" name="rateColumn" class="form-control selectpicker">
                @foreach (var column in Model.ColumnNames)
                {
                    <option value="@column.Column">@column.Name</option>
                }
            </select>
        </div>

        <div class="form-group">
            <label for="fromColumn">From column</label>
            <select id="fromColumn" name="fromColumn" class="form-control selectpicker">
                @foreach (var column in Model.ColumnNames)
                {
                    <option value="@column.Column">@column.Name</option>
                }
            </select>
        </div>

        <div class="form-group">
            <label for="toColumn">To column</label>
            <select id="toColumn" name="toColumn" class="form-control selectpicker">
                @foreach (var column in Model.ColumnNames)
                {
                    <option value="@column.Column">@column.Name</option>
                }
            </select>
        </div>

        <div class="form-group">
            <label for="descriptionColumn">Description column</label>
            <select id="descriptionColumn" name="descriptionColumn" class="form-control selectpicker">
                @foreach (var column in Model.ColumnNames)
                {
                    <option value="@column.Column">@column.Name</option>
                }
            </select>
        </div>

        <button type="submit" class="btn btn-default">Submit</button>

    </form>
}
else
{
    <form method="post" action="/timeregistration/importupload" enctype="multipart/form-data">
        <div class="form-group">
            <div style="position:relative;">
                <a class='btn btn-primary' href='javascript:;'>
                    Choose File...
                    <input type="file" style='position:absolute;z-index:2;top:0;left:0;filter: alpha(opacity=0);-ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";opacity:0;background-color:transparent;color:transparent;' name="ExcelFile" size="40" onchange='$("#upload-file-info").html($(this).val());'>
                </a>
                &nbsp;
                <span class='label label-info' id="upload-file-info"></span>
            </div>
        </div>

        <button type="submit" class="btn btn-default">Submit</button>
    </form>
}

